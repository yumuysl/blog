import{_ as a}from"./plugin-vue_export-helper-DlAUqK2U.js";import{c as n,f as i,o as s}from"./app-BXUWHIFw.js";const l={};function t(o,e){return s(),n("div",null,[...e[0]||(e[0]=[i(`<h2 id="ssl-ssl-handshake-failed" tabindex="-1"><a class="header-anchor" href="#ssl-ssl-handshake-failed"><span>SSL：SSL handshake failed</span></a></h2><h3 id="问题详情" tabindex="-1"><a class="header-anchor" href="#问题详情"><span>问题详情</span></a></h3><ul><li>在把域名DNS服务器改为<code>Cloudflare</code>的域名后出于安全考虑使用HTTPS服务，在<code>Cloudflare</code>中设置了SSL加密模式为<code>FULL(strcut)</code>，需要在源服务器中安装<code>Cloudflare</code>的<code>CA</code>证书，配置完毕后打开浏览器输入域名，出现了<code>SSL handshake failed</code>的问题</li></ul><h3 id="问题原因" tabindex="-1"><a class="header-anchor" href="#问题原因"><span>问题原因</span></a></h3><p>出现SSL握手失败的原因很多，大概可归类于以下原因，需要仔细排查</p><ul><li><p>证书不匹配：源服务器的SSL证书不包含域名</p><ul><li>查看是否包含域名：<code>echo | openssl s_client -connect 服务器IP:443 -servername 域名 2&gt;/dev/null | openssl x509 -noout -text | grep &quot;DNS:&quot;</code></li></ul></li><li><p>证书失效</p><ul><li>查看有效期：<code>echo | openssl s_client -connect 服务器IP:443 2&gt;/dev/null | openssl x509 -noout -dates</code></li></ul></li><li><p>协议不兼容：服务器和Cloudflare使用的加密协议版本不一致</p><ul><li>查看：查看tsl1.0终端输入<code>openssl s_client -connect &lt;你的服务器IP&gt;:443 -tls1</code>，查看<code>tsl1.1</code>、<code>tsl1.2</code>、<code>tsl1.3</code>只需要更改最后的参数<code>-tsl + 版本</code>，</li></ul><div class="language-text line-numbers-mode" data-highlighter="shiki" data-ext="text" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-text"><span class="line"><span>    Can&#39;t use SSL_get_servername</span></span>
<span class="line"><span>depth=0 O = &quot;CloudFlare, Inc.&quot;, OU = CloudFlare Origin CA, CN = CloudFlare Origin Certificate</span></span>
<span class="line"><span>    verify error:num=20:unable to get local issuer certificate</span></span>
<span class="line"><span>    verify return:1</span></span>
<span class="line"><span>    depth=0 O = &quot;CloudFlare, Inc.&quot;, OU = CloudFlare Origin CA, CN = CloudFlare Origin Certificate</span></span>
<span class="line"><span>    verify error:num=21:unable to verify the first certificate</span></span>
<span class="line"><span>    verify return:1</span></span>
<span class="line"><span>    depth=0 O = &quot;CloudFlare, Inc.&quot;, OU = CloudFlare Origin CA, CN = CloudFlare Origin Certificate</span></span>
<span class="line"><span>    verify return:1</span></span>
<span class="line"><span>    Certificate chain</span></span>
<span class="line"><span>    0 s:O = &quot;CloudFlare, Inc.&quot;, OU = CloudFlare Origin CA, CN = CloudFlare Origin Certificate</span></span>
<span class="line"><span>    i:C = US, ST = California, L = San Francisco, O = &quot;CloudFlare, Inc.&quot;, OU = CloudFlare Origin SSL ECC Certificate Authority</span></span>
<span class="line"><span>    a:PKEY: id-ecPublicKey, 256 (bit); sigalg: ecdsa-with-SHA256</span></span>
<span class="line"><span>    v:NotBefore: Sep  4 17:18:00 2025 GMT; NotAfter: Aug 31 17:18:00 2040 GMT</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>时间不同步：服务器时间不准确导致证书&quot;过期&quot;</p><ul><li>安装并同步时间：<code>sudo apt install ntpdate</code>、<code>sudo ntpdate pool.ntp.org</code></li></ul></li><li><p>配置错误：Nginx/Apache的SSL配置有问题</p><ul><li>查看nginx中ssl的配置，证书和密钥路径是否正确</li></ul></li></ul><h3 id="解决方案" tabindex="-1"><a class="header-anchor" href="#解决方案"><span>解决方案</span></a></h3><ul><li>证书不匹配、失效等问题：申请并重新安装CA证书</li><li>协议不兼容：上述分析中，出现<code> verify error:num=20:unable to get local issuer certificate</code>，这是问题的关键所在，即<code>OpenSSL</code> 在本地信任库中找不到签发此证书的根证书颁发机构（CA）,</li></ul>`,8)])])}const c=a(l,[["render",t]]),p=JSON.parse('{"path":"/notes/endnotes/domain/%E9%97%AE%E9%A2%98%E8%AE%B0%E5%BD%95SSL%EF%BC%9ASSL%20handshake%20failed.html","title":"问题记录SSL：SSL handshake failed","lang":"zh-CN","frontmatter":{"title":"问题记录SSL：SSL handshake failed","date":"2025-09-05T00:00:00.000Z","tag":"问题记录","icon":"file","description":"记录解决SSL：SSL handshake failed问题的过程","head":[["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"问题记录SSL：SSL handshake failed\\",\\"image\\":[\\"\\"],\\"datePublished\\":\\"2025-09-05T00:00:00.000Z\\",\\"dateModified\\":\\"2025-09-20T19:57:16.000Z\\",\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"禹穆穆\\"}]}"],["meta",{"property":"og:url","content":"https://bestoaloe.gitee.io/notes/endnotes/domain/%E9%97%AE%E9%A2%98%E8%AE%B0%E5%BD%95SSL%EF%BC%9ASSL%20handshake%20failed.html"}],["meta",{"property":"og:site_name","content":"禹穆穆"}],["meta",{"property":"og:title","content":"问题记录SSL：SSL handshake failed"}],["meta",{"property":"og:description","content":"记录解决SSL：SSL handshake failed问题的过程"}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:updated_time","content":"2025-09-20T19:57:16.000Z"}],["meta",{"property":"article:tag","content":"问题记录"}],["meta",{"property":"article:published_time","content":"2025-09-05T00:00:00.000Z"}],["meta",{"property":"article:modified_time","content":"2025-09-20T19:57:16.000Z"}]]},"git":{"createdTime":1757521032000,"updatedTime":1758398236000,"contributors":[{"name":"yumuysl","username":"","email":"yinchuanyjw@outlook.com","commits":2}]},"readingTime":{"minutes":1.87,"words":560},"filePathRelative":"notes/endnotes/domain/问题记录SSL：SSL handshake failed.md","excerpt":""}');export{c as comp,p as data};
