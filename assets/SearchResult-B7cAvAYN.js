import{g as V,u as W,h as X,i as Z,j as ee,k as le,l as se,m as R,n as C,p as e,q as ae,s as te,v as re,R as $,x as ie,y as oe,z as ue,A as ce,B as ne,C as I,D as T,E as Ee,F as he,G as ve,H as de,L as me,I as Be,J as ye,K as Ae,M,N as pe,O as D}from"./app-CkvgXyJu.js";const ge=["/intro.html","/","/codeshare/","/livelog/","/somelink/aboutme.html","/somelink/friendlink.html","/somelink/","/somelink/toolink.html","/codeshare/caseshare/","/codeshare/othershare/Lazyvim%E7%BC%96%E8%BE%91%E5%99%A8.html","/codeshare/othershare/","/codeshare/othershare/win11%E5%BC%80%E6%9C%BA%E8%87%AA%E5%8A%A8%E6%89%A7%E8%A1%8C%E8%84%9A%E6%9C%AC%E6%96%87%E4%BB%B6.html","/codeshare/othershare/%E5%86%85%E7%BD%91%E7%A9%BF%E9%80%8F.html","/codeshare/othershare/%E5%AE%9E%E7%8E%B0%E6%89%8B%E6%9C%BA%E5%B1%8F%E5%B9%95%E6%9B%BF%E6%8D%A2%E7%94%B5%E8%84%91%E9%BC%A0%E6%A0%87.html","/codeshare/othershare/%E6%8F%90%E5%8D%87vim%E7%BC%96%E8%BE%91%E4%BD%93%E9%AA%8C.html","/livelog/philosophy/","/livelog/philosophy/%E4%B8%80%E4%BA%9B%E6%83%B3%E6%B3%95.html","/livelog/philosophy/%E6%AF%9B%E9%80%89.html","/livelog/daily/%E5%8E%BB%E8%BF%87%E7%9A%84%E5%9C%B0%E6%96%B9.html","/livelog/daily/%E8%BF%99%E4%B8%AA%E4%B8%8D%E8%83%BD%E5%BF%8D.html","/livelog/daily/%E8%BF%99%E4%B8%AA%E5%BF%85%E9%A1%BB%E5%A4%B8.html","/livelog/daily/%E8%BF%99%E4%B8%AA%E8%BF%98%E8%83%BD%E5%BF%8D.html","/livelog/poetry/","/codeshare/caseshare/cssnotes/","/codeshare/caseshare/cssnotes/%E6%AF%9B%E7%8E%BB%E7%92%83%E6%95%88%E6%9E%9C.html","/codeshare/caseshare/tspros/","/codeshare/caseshare/tspros/%E4%BF%84%E7%BD%97%E6%96%AF%E6%96%B9%E5%9D%97.html","/codeshare/caseshare/tspros/%E8%B4%AA%E5%90%83%E8%9B%87.html","/livelog/poetry/libai/","/livelog/poetry/libai/%E5%AE%A3%E5%B7%9E%E8%B0%A2%E6%9C%93%E6%A5%BC%E9%A5%AF%E5%88%AB%E6%A0%A1%E4%B9%A6%E5%8F%94%E4%BA%91.html","/livelog/poetry/libai/%E5%B0%86%E8%BF%9B%E9%85%92.html","/livelog/poetry/sushi/","/livelog/poetry/sushi/%E5%AE%9A%E9%A3%8E%E6%B3%A2-%E8%8E%AB%E5%90%AC%E7%A9%BF%E6%9E%97%E6%89%93%E5%8F%B6%E5%A3%B0.html","/livelog/poetry/sushi/%E5%BF%B5%E5%A5%B4%E5%A8%87-%E8%B5%A4%E5%A3%81%E6%80%80%E5%8F%A4.html","/livelog/poetry/sushi/%E6%9C%9B%E6%B1%9F%E5%8D%97-%E6%98%A5%E6%9C%AA%E8%80%81.html","/livelog/poetry/sushi/%E6%B0%B4%E8%B0%83%E6%AD%8C%E5%A4%B4.html","/livelog/poetry/zhangruoxu/","/livelog/poetry/zhangruoxu/%E4%BB%A3%E7%AD%94%E9%97%BA%E6%A2%A6%E8%BF%98.html","/livelog/poetry/zhangruoxu/%E6%98%A5%E6%B1%9F%E8%8A%B1%E6%9C%88%E5%A4%9C.html","/404.html","/livelog/daily/","/category/","/tag/","/tag/%E9%93%BE%E6%8E%A5/","/tag/linux/","/tag/win11/","/tag/%E5%86%85%E7%BD%91%E7%A9%BF%E9%80%8F/","/tag/%E5%93%B2%E5%AD%A6/","/tag/%E8%AF%97%E8%AF%8D/","/article/","/star/","/timeline/"],Fe="SLIMSEARCH_QUERY_HISTORY",y=M(Fe,[]),Ce=()=>{const{queryHistoryCount:t}=D;return{enabled:t>0,queryHistories:y,addQueryHistory:u=>{y.value=Array.from(new Set([u,...y.value.slice(0,t-1)]))},removeQueryHistory:u=>{y.value=[...y.value.slice(0,u),...y.value.slice(u+1)]}}},Q=t=>ge[t.id]+("anchor"in t?`#${t.anchor}`:""),De="SLIMSEARCH_RESULT_HISTORY",{resultHistoryCount:z}=D,A=M(De,[]),fe=()=>({enabled:z>0,resultHistories:A,addResultHistory:o=>{{const u={link:Q(o),display:o.display};"header"in o&&(u.header=o.header),A.value=[u,...A.value.slice(0,z-1)]}},removeResultHistory:o=>{A.value=[...A.value.slice(0,o),...A.value.slice(o+1)]}}),ke=t=>{const{page:o,routeLocale:u}=Ee(),f=he(),r=R(0),p=C(()=>r.value>0),E=ve([]);return de(()=>{const{search:k,terminate:d}=me(),g=ye(m=>{const{resultsFilter:H=a=>a,querySplitter:B,suggestionsFilter:S,...i}=f.value;m?(r.value+=1,k(m,u.value,i).then(a=>H(a,m,u.value,o.value)).then(a=>{r.value-=1,E.value=a}).catch(a=>{console.warn(a),r.value-=1,r.value||(E.value=[])})):E.value=[]},D.searchDelay-D.suggestDelay,{maxWait:5e3});Be([t,u],([m])=>g(m.join(" "))),Ae(()=>{d()})}),{isSearching:p,results:E}};var xe=V({name:"SearchResult",props:{queries:{type:Array,required:!0},isFocusing:Boolean},emits:["close","updateQuery"],setup(t,{emit:o}){const u=W(),f=X(),r=Z(ee),{addQueryHistory:p,queryHistories:E,removeQueryHistory:k}=Ce(),{resultHistories:d,addResultHistory:g,removeResultHistory:m}=fe(),H=le(t,"queries"),{results:B,isSearching:S}=ke(H),i=se({isQuery:!0,index:0}),a=R(0),h=R(0),q=C(()=>E.value.length>0||d.value.length>0),x=C(()=>B.value.length>0),b=C(()=>B.value[a.value]||null),j=()=>{const{isQuery:l,index:s}=i;s===0?(i.isQuery=!l,i.index=l?d.value.length-1:E.value.length-1):i.index=s-1},O=()=>{const{isQuery:l,index:s}=i;s===(l?E.value.length-1:d.value.length-1)?(i.isQuery=!l,i.index=0):i.index=s+1},U=()=>{a.value=a.value>0?a.value-1:B.value.length-1,h.value=b.value.contents.length-1},_=()=>{a.value=a.value<B.value.length-1?a.value+1:0,h.value=0},P=()=>{h.value<b.value.contents.length-1?h.value+=1:_()},Y=()=>{h.value>0?h.value-=1:U()},w=l=>l.map(s=>pe(s)?s:e(s[0],s[1])),G=l=>{if(l.type==="customField"){const s=ce[l.index]||"$content",[v,c=""]=ne(s)?s[f.value].split("$content"):s.split("$content");return l.display.map(n=>e("div",w([v,...n,c])))}return l.display.map(s=>e("div",w(s)))},F=()=>{a.value=0,h.value=0,o("updateQuery",""),o("close")},J=()=>e("div",{class:"slimsearch-records"},e("div",{class:"slimsearch-record"},[e("div",{class:"slimsearch-record-title"},r.value.queryHistory),e("ul",{class:"slimsearch-record-contents",role:"listbox"},E.value.map((l,s)=>{const v=i.isQuery&&i.index===s;return e("li",{class:["slimsearch-record-matches",{active:v}],role:"option","aria-selected":v,onClick:()=>{o("updateQuery",l)}},e("div",[e(I,{class:"slimsearch-record-type"}),e("div",{class:"slimsearch-record-content"},l),e("button",{type:"button",class:"slimsearch-remove-icon",title:r.value.remove,"aria-label":r.value.remove,innerHTML:T,onClick:c=>{c.preventDefault(),c.stopPropagation(),k(s)}})]))}))])),K=()=>e("ul",{class:"slimsearch-records"},e("li",{class:"slimsearch-record"},[e("div",{class:"slimsearch-record-title"},r.value.resultHistory),e("ul",{class:"slimsearch-record-contents",role:"listbox"},d.value.map((l,s)=>{const v=!i.isQuery&&i.index===s;return e("li",{class:["slimsearch-record-matches",{active:v}],role:"option","aria-selected":v},e($,{to:l.link,onClick:()=>{F()}},()=>[e(I,{class:"slimsearch-record-type"}),e("div",{class:"slimsearch-record-content"},[l.header?e("div",{class:"slimsearch-record-content-header"},l.header):null,e("div",l.display.map(c=>w(c)).flat())]),e("button",{type:"button",class:"slimsearch-remove-icon",title:r.value.remove,"aria-label":r.value.remove,innerHTML:T,onClick:c=>{c.preventDefault(),c.stopPropagation(),m(s)}})]))}))]));return ae("keydown",l=>{if(t.isFocusing){if(x.value){if(l.key==="ArrowUp")Y();else if(l.key==="ArrowDown")P();else if(l.key==="Enter"){const s=b.value.contents[h.value];p(t.queries.join(" ")),g(s),u.push(Q(s)),F()}}else if(l.key==="ArrowUp")j();else if(l.key==="ArrowDown")O();else if(l.key==="Enter"){const{index:s}=i;i.isQuery?(l.preventDefault(),o("updateQuery",E.value[s])):(u.push(d.value[s].link),F())}}}),te([a,h],()=>{document.querySelector(".slimsearch-record.active .slimsearch-record-matches.active")?.scrollIntoView(!1)},{flush:"post"}),()=>e("div",{id:"slimsearch-results",class:["slimsearch-result-wrapper",{empty:t.queries.length?!x.value:!q.value}]},t.queries.length?S.value?e(re,{hint:r.value.searching}):x.value?e("div",{class:"slimsearch-records",role:"listbox","aria-labeledby":"slimsearch-label"},B.value.map(({title:l,contents:s},v)=>{const c=a.value===v;return e("div",{class:["slimsearch-record",{active:c}],role:"group","aria-selected":c},[e("div",{class:"slimsearch-record-title"},l||r.value.defaultTitle),e("ul",{class:"slimsearch-record-contents"},s.map((n,N)=>{const L=c&&h.value===N;return e("li",{class:["slimsearch-record-matches",{active:L}],role:"option","aria-selected":L},e($,{to:Q(n),onClick:()=>{p(t.queries.join(" ")),g(n),F()}},()=>[n.type==="text"?null:e(n.type==="title"?ie:n.type==="heading"?oe:ue,{class:"slimsearch-record-type"}),e("div",{class:"slimsearch-record-content"},[n.type==="text"&&n.header?e("div",{class:"slimsearch-record-content-header"},n.header):null,e("div",G(n))])]))}))])})):r.value.emptyResult:q.value?[J(),K()]:r.value.emptyHistory)}});export{xe as default};
